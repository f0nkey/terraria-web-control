<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Dino Doggos - Terraria Control Panel</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap" rel="stylesheet">

  <body>
    <div class="main">
      <div class="logo"></div>
      <div class="title">Dino Doggos</div>
      <div class="subtitle">Terraria Control Panel</div>
      <div class="buttons">
        <div><button id="dawn" onclick="setDawn()">Dawn</button></div>
        <div><button id="noon" onclick="setNoon()">Noon</button></div>
        <div><button id="dusk" onclick="setDusk()">Dusk</button></div>
        <div><button id="midnight" onclick="setMidnight()">Midnight</button></div>
        <div><button id="save" onclick="saveServer()">Save</button></div>
        <div><button id="reset" onclick="resetServer()">Reset</button></div>
      </div>
    </div>

    <script>
      function resetServer() {
        confirm("This will RESET the server and changes WILL NOT BE SAVED. Are you sure you want to continue?")
      }
      function saveServer() {
        confirm("This will SAVE the server in its current state. Are you sure you want to continue?")
      }
      function setDawn() {
        confirm("This will change the current time of day to DAWN. Are you sure you want to continue?")
      }
      function setNoon() {
        confirm("This will change the current time of day to NOON. Are you sure you want to continue?")
      }
      function setDusk() {
        confirm("This will change the current time of day to DUSK. Are you sure you want to continue?")
      }
      function setMidnight() {
        confirm("This will change the current time of day to MIDNIGHT. Are you sure you want to continue?")
      }
      function submitCommand(cmd) {
        let url = window.location.href + "cmd"
        fetch(url, {method: "POST", body:cmd})
            .then(response => response.json())
            .then((data) => {
                if(data.msg === "error") {
                    setCmdStatus("Encountered error: " + data.error)
                    return
                }
                setCmdStatus("Processed command successfully.")
            }).catch((e) => {
            setCmdStatus("Encountered error: " + e)
        });
    }

    function setCmdStatus(text) {
        let el = document.getElementById("command-status")
        el.innerText = text
        el.classList.remove("anim")
        void el.offsetWidth
        el.classList.add("anim")
    }

    document.getElementById("dusk").addEventListener("click", ()=> {
        submitCommand("dusk")
    })
    document.getElementById("dawn").addEventListener("click", ()=> {
        submitCommand("dawn")
    })
    document.getElementById("noon").addEventListener("click", ()=> {
        submitCommand("noon")
    })
    document.getElementById("midnight").addEventListener("click", ()=> {
        submitCommand("midnight")
    })
    </script>
  </body>
</html>
